s = "  variable ADDR\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable EAX\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable EBX\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable ECX\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable EDX\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable EIP\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable EFL\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable CPL\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable II\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable A20\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable SMM\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable HLT\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable ES\n" + "	var-kind variable\n" + "	rep-type string\n" + "	dec-type char*\n" + "	comparability 2\n" + "  variable CS\n" + "	var-kind variable\n" + "	rep-type string\n" + "	dec-type char*\n" + "	comparability 2\n" + "  variable SS\n" + "	var-kind variable\n" + "	rep-type string\n" + "	dec-type char*\n" + "	comparability 2\n" + "  variable DS\n" + "	var-kind variable\n" + "	rep-type string\n" + "	dec-type char*\n" + "	comparability 2\n" + "  variable FS\n" + "	var-kind variable\n" + "	rep-type string\n" + "	dec-type char*\n" + "	comparability 2\n" + "  variable GS\n" + "	var-kind variable\n" + "	rep-type string\n" + "	dec-type char*\n" + "	comparability 2\n" + "  variable LDT\n" + "	var-kind variable\n" + "	rep-type string\n" + "	dec-type char*\n" + "	comparability 2\n" + "  variable TR\n" + "	var-kind variable\n" + "	rep-type string\n" + "	dec-type char*\n" + "	comparability 2\n" + "  variable ES_DPL\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable CS_DPL\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable SS_DPL\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable DS_DPL\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable FS_DPL\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable GS_DPL\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable LDT_DPL\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable TR_DPL\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable GDT\n" + "	var-kind variable\n" + "	rep-type string\n" + "	dec-type char*\n" + "	comparability 2\n" + "  variable IDT\n" + "	var-kind variable\n" + "	rep-type string\n" + "	dec-type char*\n" + "	comparability 2\n" + "  variable CR0\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable CR2\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable CR3\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable CR4\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable DR0\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable DR1\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable DR2\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable DR3\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable DR6\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable DR7\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable CCS\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable CCD\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable CC0\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1 \n" + "  variable EFER\n" + "	var-kind variable\n" + "	rep-type int\n" + "	dec-type int\n" + "	comparability 1\n"  

a = "	var-kind variable\n" + "	rep-type string\n" + "	dec-type char*\n" + "	comparability 2\n"

def parse():
	uniq_insts = set()
	for name in ["cs", "cs2", "boot"]:
		for line in open(name + ".txt", "r"):
			if line[0] == "0" and line[1] == "x" and len(line) > 39:
				#print(line)
				uniq_insts.add(line[38:].replace("rep ","").split()[0])
			if "Servicing hardware INT=" in line: # interrupt start case
				uniq_insts.add(line.replace("Servicing hardware INT=", "").rstrip())
				uniq_insts.add("new" + line.replace("Servicing hardware INT=", "").rstrip())
				#print(line)
	#print(uniq_insts)
	#special cases
	for spec in ["calll","jmp","ret"]:
		if spec in uniq_insts:
			uniq_insts.remove(spec)
			uniq_insts.add(spec + "_near")
			uniq_insts.add(spec + "_far")
	add = ""
	out = open("in_trace.decls", "w")
	out.write("input-language C/C++\ndecl-version 2.0\nvar-comparability implicit\n\n") # header
	#exit()
	for i in list(uniq_insts):
		#print(i)
		add = ""
		for j in range(1,3):
			add += "  variable ARG" + str(j) + "\n" + a
		out.write("ppt .."+i + "():::ENTER\n  ppt-type enter\n" + add + s + '\n')
		out.write("ppt .."+i + "():::EXIT0\n  ppt-type subexit\n" + add + s + '\n')
		
	return uniq_insts
			
parse()